codetasty.revision.2.0
{"ts":1501675815,"restoring":false,"user_id":4164,"patch":[{"diffs":[[1,"<?php\n\nuse Illuminate\\Support\\Facades\\Schema;\nuse Illuminate\\Database\\Schema\\Blueprint;\nuse Illuminate\\Database\\Migrations\\Migration;\n\nclass CreatePreventionsTable extends Migration\n{\n    /**\n     * Run the migrations.\n     *\n     * @return void\n     */\n    public function up()\n    {\n        Schema::create('preventions', function (Blueprint $table) {\n            $table->increments('id');\n            $table->integer('object_id')->unsigned();\n            $table->integer('fact_id')->unsigned();\n            $table->integer('executor_id')->unsigned();\n            $table->integer('preparation_receipt_id')->unsigned();\n            $table->integer('application_method_id')->unsigned();\n            $table->enum('service_type', ['профилактическая', 'вынужденная'])->default('профилактическая');\n            $table->integer('count')->unsigned();\n            $table->integer('count_gz')->unsigned();\n            $table->integer('count_final')->unsigned();\n            $table->integer('count_ill')->unsigned();\n            $table->integer('count_rip')->unsigned();\n            $table->string('comment', 255)->nullable();\n            $table->integer('preparation_used_doses')->unsigned()->default(0);\n            $table->float('preparation_used_containers', 8, 2)->default(0);\n            $table->integer('preparation_destroyed_doses')->unsigned()->default(0);\n            $table->timestamps();\n        });\n\n        Schema::table('preventions', function($table) {\n            $table->foreign('object_id')->references('id')->on('objects')->onDelete('cascade');;\n            $table->foreign('fact_id')->references('id')->on('facts')->onDelete('cascade');;\n            $table->foreign('executor_id')->references('id')->on('executors');\n            $table->foreign('preparation_receipt_id')->references('id')->on('preparation_receipts');\n            $table->foreign('application_method_id')->references('id')->on('application_methods');\n        });\n    }\n\n    /**\n     * Reverse the migrations.\n     *\n     * @return void\n     */\n    public function down()\n    {\n        Schema::dropIfExists('preventions');\n    }\n}\n"]],"start1":0,"start2":0,"length1":0,"length2":2107}],"length":2107}